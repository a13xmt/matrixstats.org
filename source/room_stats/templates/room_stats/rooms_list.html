{% extends 'room_stats/base.html' %}
{% load custom_filters %}

{% block title %}
  {{ title }}
{% endblock %}

{% block content %}

  {% if header %}
    <h1>{{ header }}</h1>
  {% endif %}

  <div itemscope itemtype="https://schema.org/BreadcrumbList">


  {% for room in rooms %}
    {% url 'room-stats' room_id=room.id as room_url %}

    <div itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">

      <a class="room-container" href="{% url 'room-stats' room_id=room.id %}" itemprop="item">
        <meta itemprop="position" content="{{ forloop.counter }}" />
        <meta itemprop="name" content="{{ room.name }}" />
        <meta itemprop="alternateName" content="{{ room.id }}" />
        <meta itemprop="identifier" content="{{ room.id }}" />

        <div class="room-logo">
          <img src="{{ room.get_logo_url }}" itemprop="image" />
        </div>

        <div class="room-side-container">
          <div class="room-header" itemprop="name">
            {{ room.name | slice:":60"}}
          </div>

          <div class="room-description" itemprop="description">

            {% if room.topic %}
              {{ room.topic | format_lines | linebreaks }}
            {% else %}
            <span class="blur">There is no topic available. Lorem ipsum dolor sit amet, consectetur adipiscing elit.<br/>
              Aliquam sagittis augue quis velit hendrerit volutpat. Maecenas imperdiet augue libero, laoreet malesuada.<br/>
              Pellentesque sit amet turpis non lacus auctor ultricies in eget odio velit.</span>
            {% endif %}
          </div>

          <div class="room-details">

            <div class="room-members">
              {{ room.members_count }}

              <div class="room-members-modifier">
                {% if rating %}
                  {% if rating == 'absolute' %}
                    {{ room.delta|stringformat:"+d" }}
                  {% endif %}
                  {% if rating == 'relative' %}
                    {% if room.members_from == 0 or room.percentage > 300 %}
                      New
                    {% else %}
                      {% if room.percentage > 0 %}+{% else %}-{% endif %}{{ room.percentage|floatformat:"2" }}&#37;
                    {% endif %}
                  {% endif %}
                {% endif %}
              </div>
            </div>

            <div class="room-category">
              {{ room.category.name }}
            </div>

          </div>
        </div>


      </a>

  {% endfor %}

  {% if rooms.has_other_pages %}
    <div class="pagination">
      {% if rooms.has_previous %}
        <a href="?page={{ rooms.previous_page_number }}">&laquo;</a>
      {% endif %}

      <a class="active">{{ rooms.number }} / {{ rooms.paginator.num_pages}}</a>

      {% if rooms.has_next %}
        <a href="?page={{ rooms.next_page_number }}">&raquo;</a>
      {% endif %}
    </div>
  {% endif %}


  </div>
{% endblock content %}
